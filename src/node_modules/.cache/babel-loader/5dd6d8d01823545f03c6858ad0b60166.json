{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\SSCM\\\\ss\\\\src\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\SSCM\\\\ss\\\\src\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\SSCM\\\\ss\\\\src\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\SSCM\\\\ss\\\\src\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";/*\r\n* Import polling hook\r\n*\r\n*/import React from'react';import{connect}from\"react-redux\";import RestApiModule from'../RestApiModule';import{Jumbotron}from'reactstrap';var ImportPolling=/*#__PURE__*/function(_React$Component){_inherits(ImportPolling,_React$Component);var _super=_createSuper(ImportPolling);function ImportPolling(props){var _this;_classCallCheck(this,ImportPolling);_this=_super.call(this,props);_this.restApi=new RestApiModule();_this.interval=null;_this.intervalTime=+process.env.REACT_APP_IMPORT_POLLING_INTERVAL;_this.state={importOngoing:false,uname:null};return _this;}_createClass(ImportPolling,[{key:\"componentDidMount\",value:function componentDidMount(){this.tickStarter();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){this.tickStarter();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.interval);}},{key:\"tickStarter\",value:function tickStarter(){var _this2=this;var _this$props=this.props,token=_this$props.token,importPolling=_this$props.importPolling;if(token&&importPolling){this.interval=setInterval(function(){_this2.tick();},this.intervalTime);}else{clearInterval(this.interval);}}},{key:\"tick\",value:function tick(){var _this3=this;var token=this.props.token;var importOngoing=this.state.importOngoing;this.restApi.callApi('getImportStatus',{token:token}).then(function(response){var _response$isImportOng=response.isImportOngoing,islock=_response$isImportOng.islock,uname=_response$isImportOng.uname;if(importOngoing!==islock){_this3.setState({importOngoing:islock,uname:uname});// if isLock variable value is false that means is before status is true.\n// So we can understand there was an import action and it's done now.\n// if this happen we need to refresh the data.\nif(!islock)document.location.reload();}});}},{key:\"render\",value:function render(){var _this$state=this.state,importOngoing=_this$state.importOngoing,uname=_this$state.uname;var language=this.props.language;if(importOngoing){var message=language.importSection.ongoingImportText.replace('{username}',uname);return/*#__PURE__*/React.createElement(\"div\",{className:'empty-data'},/*#__PURE__*/React.createElement(Jumbotron,{className:\"empty-data-content\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"display-5\"},language.importSection.ongoingImportTitle),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"p\",{className:\"lead\"},message)));}else{return/*#__PURE__*/React.createElement(React.Fragment,null);}}}]);return ImportPolling;}(React.Component);function mapStateToProps(state){return{token:state.token,language:state.language,importPolling:state.importPolling};}export default connect(mapStateToProps)(ImportPolling);","map":{"version":3,"sources":["C:/Users/ezerdon/Desktop/SSCM/ss/src/src/components/ImportPolling.jsx"],"names":["React","connect","RestApiModule","Jumbotron","ImportPolling","props","restApi","interval","intervalTime","process","env","REACT_APP_IMPORT_POLLING_INTERVAL","state","importOngoing","uname","tickStarter","prevProps","prevState","snapshot","clearInterval","token","importPolling","setInterval","tick","callApi","then","response","isImportOngoing","islock","setState","document","location","reload","language","message","importSection","ongoingImportText","replace","ongoingImportTitle","Component","mapStateToProps"],"mappings":"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","sourcesContent":["/*\r\n* Import polling hook\r\n*\r\n*/\r\nimport React from 'react'\r\nimport {connect} from \"react-redux\";\r\n\r\nimport RestApiModule from '../RestApiModule'\r\nimport {Jumbotron} from 'reactstrap';\r\n\r\n\r\nclass ImportPolling extends React.Component{\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.restApi = new RestApiModule();\r\n        this.interval = null;\r\n        this.intervalTime = +process.env.REACT_APP_IMPORT_POLLING_INTERVAL;\r\n        this.state = {\r\n            importOngoing: false,\r\n            uname: null\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.tickStarter();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        this.tickStarter();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearInterval(this.interval);\r\n    }\r\n\r\n    tickStarter() {\r\n        const {token, importPolling} = this.props;\r\n\r\n        if (token && importPolling) {\r\n            this.interval = setInterval(() => {\r\n                this.tick()\r\n            }, this.intervalTime)\r\n        } else {\r\n            clearInterval(this.interval);\r\n        }\r\n    }\r\n\r\n    tick() {\r\n        const {token} = this.props;\r\n        const {importOngoing} = this.state;\r\n\r\n        this.restApi.callApi('getImportStatus', {\r\n            token\r\n        }).then(response => {\r\n\r\n            const {islock, uname} = response.isImportOngoing\r\n\r\n            if (importOngoing !== islock) {\r\n                this.setState({\r\n                    importOngoing: islock,\r\n                    uname\r\n                })\r\n\r\n                // if isLock variable value is false that means is before status is true.\r\n                // So we can understand there was an import action and it's done now.\r\n                // if this happen we need to refresh the data.\r\n                if (!islock) document.location.reload();\r\n            }\r\n        })\r\n    }\r\n\r\n    render() {\r\n        const {importOngoing, uname} = this.state;\r\n        const {language} = this.props;\r\n\r\n        if (importOngoing) {\r\n\r\n            const message = language.importSection.ongoingImportText.replace('{username}', uname);\r\n\r\n            return (\r\n                <div className={'empty-data'}>\r\n                    <Jumbotron className=\"empty-data-content\">\r\n                        <h1 className=\"display-5\">{language.importSection.ongoingImportTitle}</h1>\r\n                        <hr/>\r\n                        <p className=\"lead\">{message}</p>\r\n                    </Jumbotron>\r\n                </div>\r\n\r\n            )\r\n        } else {\r\n            return (<></>)\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        token: state.token,\r\n        language: state.language,\r\n        importPolling: state.importPolling\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(ImportPolling)\r\n"]},"metadata":{},"sourceType":"module"}