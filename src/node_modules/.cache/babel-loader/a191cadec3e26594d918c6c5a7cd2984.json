{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\soperasyon27\\\\Desktop\\\\FE\\\\src18mart\\\\src\\\\src\\\\views\\\\Main.jsx\";\nimport React, { createRef } from 'react';\nimport { connect } from \"react-redux\";\nimport Axios from 'axios';\nimport { HotTable } from '@handsontable/react';\nimport 'handsontable/dist/handsontable.full.css';\nimport { Row, Col, Card, CardBody, CardFooter } from 'reactstrap';\nimport Header from '../components/Header';\nimport Sidebar from \"../components/Sidebar\";\nimport RestApiModule from '../RestApiModule';\nimport { editOnToggle, spinnerToggle } from \"../redux/actions\";\nimport Toolbar from '../components/Toolbar';\nimport AlertModule from '../AlertModule';\n\nclass WDM extends React.Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n    this.hotTableComponent = createRef();\n    this.hot = null;\n    this.columns = [];\n    this.restApi = new RestApiModule();\n    this.handsontableDataBackup = null;\n    this.handsontableData = null;\n    this.alert = new AlertModule();\n    this.selectedRowCoords = {\n      r: null,\n      c: null\n    };\n    this.editedRowCoords = {\n      r: null,\n      c: null\n    };\n    this.state = {\n      columns: [],\n      data: [],\n      newArrColumns: [],\n      ColumnsInOrder: [\"SKU\", \"Tedarikçi SKU\", \"Ürün İsmi\", \"Liste Fiyatı\", \"Satış Fiyatı\", \"İnd.Oran(%)\", \"Stok Adet\", \"T.Adet\", \"T.Sıra\", \"Ürt.Tar.\", \"Hz.Sr.\"],\n      newArrData: [],\n      newArrDataForPair: [],\n      columnOptions: []\n    };\n  }\n\n  componentDidMount() {\n    const company = localStorage.getItem('Company');\n    this.props.setSpinner();\n    this.restApi.callApi('exceldata', {\n      company: company\n    }).then(response => {\n      const json = response.data[0];\n      const jsonBig = response.data;\n\n      for (let key in json) {\n        if (json.hasOwnProperty(key)) {\n          this.state.newArrColumns.push(key);\n        }\n      }\n\n      console.log(this.state.ColumnsInOrder);\n      /*\r\n                  for(let a=0; a<jsonBig.length; a++){\r\n                      const jsonPair = response.data[a];\r\n                      console.log(jsonPair)\r\n                      for(let key in jsonPair){\r\n                          console.log(key)\r\n                          if (jsonPair.hasOwnProperty(key)) {\r\n                              this.state.newArrData.push(jsonPair[key]);\r\n                          }\r\n                      }\r\n                      this.state.data.push(this.state.newArrData);\r\n                      this.state.newArrData = [];\r\n                  }\r\n                  */\n\n      console.log(this.state.ColumnsInOrder[0]);\n\n      for (let a = 0; a < jsonBig.length; a++) {\n        const jsonPair = response.data[a];\n\n        for (let c = 0; c < 11; c++) {\n          let key = this.state.ColumnsInOrder[c];\n          this.state.newArrData.push(jsonPair[key]);\n        }\n\n        this.state.data.push(this.state.newArrData);\n        this.state.newArrData = [];\n      }\n\n      console.log(this.state.data);\n      this.state.columns.push(this.state.newArrColumns);\n      this.forceUpdate();\n      this.hot = this.hotTableComponent.current.hotInstance;\n      this.handsontableData = this.state.data; //this.hot.setCellMeta(1, 4, \"className\", 'bg-primary text-white');\n      //this.hot.render();\n\n      /* var rows=this.hot.countRows();  // get the count of the rows in the table\r\n       var cols=this.hot.countCols();  // get the count of the columns in the table.\r\n       for(var row=0; row<rows; row++){  // go through each row of the table\r\n                 var cell = this.hot.getCell(row,1);\r\n               cell.style.background = \"#00FF90\";\r\n         }\r\n         console.log(this.hot.getSettings())*/\n      //  this.hot.render();\n    }).catch(err => {\n      console.log(err);\n    });\n    this.props.setSpinner();\n    /*\r\n            //console.log(this.state.columns);\r\n            Axios({\r\n    \r\n                method: 'POST',\r\n                url: `http://localhost:8777/test-jersey-rest-maven-tomcat/rest/testservice/test12/`,\r\n                data: null,\r\n                headers: {\r\n                    'Content-Type' : 'application/json'\r\n                }\r\n            }).then(async (response) => {\r\n                console.log(\"aaaa\");\r\n    \r\n                const json = response.data[0].variants[0];\r\n                const jsonBig = response.data[0].variants;\r\n                for (let key in json) {\r\n                    if (json.hasOwnProperty(key)) {\r\n                        this.state.newArrColumns.push(key);\r\n                    }\r\n                }\r\n    \r\n                for(let a=0; a<jsonBig.length; a++){\r\n                    const jsonPair = response.data[0].variants[a];\r\n                    for(let key in jsonPair){\r\n                        if (jsonPair.hasOwnProperty(key)) {\r\n                            this.state.newArrData.push(jsonPair[key]);\r\n                        }\r\n                    }\r\n                    this.state.data.push(this.state.newArrData);\r\n                    this.state.newArrData = [];\r\n                }\r\n                this.state.columns.push(this.state.newArrColumns);\r\n                this.forceUpdate();\r\n    \r\n            }).catch((err) => {\r\n                console.log(err);\r\n            })*/\n  }\n\n  setCellProperties(r, c) {\n    const colCount = this.hot.countCols();\n    let col = c !== null ? c : 0;\n\n    for (let x = 0; x <= colCount; x++) {\n      const {\n        prop,\n        readOnly,\n        readOnlyInEditMode\n      } = this.hot.getCellMeta(r, x);\n      const type = this.hot.getDataType(r, x); // get cell type from loaded map\n\n      col = col === 0 ? x : col; // when add new row find first editable col.\n\n      this.hot.setCellMeta(r, x, \"editor\", type);\n      this.hot.setCellMeta(r, x, \"className\", 'bg-warning text-dark');\n    }\n\n    this.hot.render();\n    this.hot.selectCell(r, col);\n  }\n\n  handleEditClick() {\n    const {\n      r,\n      c\n    } = this.selectedRowCoords;\n    if (r === null && c === null) return;\n    this.handsontableDataBackup = JSON.parse(JSON.stringify(this.handsontableData)); // Change edit mode on redux\n\n    this.props.setEdit();\n    this.setCellProperties(r, c);\n    this.editedRowCoords.r = r;\n    this.editedRowCoords.c = c;\n  }\n\n  handleCancelClick() {\n    this.handsontableData = JSON.parse(JSON.stringify(this.handsontableDataBackup));\n    this.hot.loadData(this.handsontableData);\n    this.hot.render(); // Change edit mode on redux\n\n    this.props.setEdit();\n  }\n\n  handleSaveClick() {\n    console.log(\"aaaa\");\n    const {\n      r,\n      c\n    } = this.editedRowCoords;\n    let data = this.hot.getDataAtRow(r);\n    console.log(data);\n    console.log(this.state.ColumnsInOrder);\n    let finalData = {};\n    this.state.ColumnsInOrder.forEach((v, i) => {\n      finalData[v] = data[i];\n    });\n    console.log(finalData);\n    const company = localStorage.getItem('Company');\n    console.log(company);\n    this.restApi.callApi('saveRowAndSendFlxPoint', {\n      row: finalData,\n      company: company\n    }).then(response => {\n      const saveResult = response.exec_status;\n\n      if (saveResult == \"success\") {\n        this.alert.showMessage(\"success\", \"Kayıt Başarılı\", response.SKU + \" için kayıt başarılı\", false);\n        this.resetRow(r); // this method will return the edit view to normal\n\n        this.props.setEdit();\n      } else {}\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  resetRow(r) {\n    const colCount = this.hot.countCols();\n\n    for (let x = 0; x <= colCount; x++) {\n      this.hot.setCellMeta(r, x, \"editor\", false);\n      this.hot.setCellMeta(r, x, \"className\", 'bg-primary text-white');\n    }\n\n    this.hot.render();\n    this.setState({\n      newRowAdded: false\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Row, {\n      className: \"h-100\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Sidebar, {\n      maximize: this.props.maximize,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Col, {\n      className: this.props.contentCSS,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Toolbar, {\n      wrapper: 'toolbar mt-2',\n      isDataExist: this.state.isDataExistsInDB,\n      newRowAdded: this.state.newRowAdded,\n      edit: this.handleEditClick.bind(this),\n      cancel: this.handleCancelClick.bind(this),\n      save: this.handleSaveClick.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Card, {\n      className: 'mt-1 fixedCard',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(HotTable, {\n      ref: this.hotTableComponent,\n      id: 'hot',\n      data: this.state.data,\n      stretchH: 'all',\n      autoRowSize: true,\n      autoWrapRow: true,\n      dropdownMenu: true,\n      filters: true,\n      manualColumnResize: true,\n      columnSorting: true,\n      colHeaders: this.state.ColumnsInOrder,\n      rowHeaders: true,\n      width: '100%',\n      height: '100%',\n      licenseKey: \"non-commercial-and-evaluation\",\n      afterSelectionEnd: (r, c) => {\n        this.selectedRowCoords.r = r;\n        this.selectedRowCoords.c = c;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 33\n      }\n    }))))));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    token: state.token,\n    company: state.company,\n    language: state.language,\n    maximize: state.maximize,\n    contentCSS: state.contentCSS,\n    fontSize: state.topologySelectedNodeFontSize,\n    spinnerToggle: state.spinnerToggle\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    setEdit: () => dispatch(editOnToggle()),\n    setSpinner: () => dispatch(spinnerToggle())\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WDM);","map":{"version":3,"sources":["C:/Users/soperasyon27/Desktop/FE/src18mart/src/src/views/Main.jsx"],"names":["React","createRef","connect","Axios","HotTable","Row","Col","Card","CardBody","CardFooter","Header","Sidebar","RestApiModule","editOnToggle","spinnerToggle","Toolbar","AlertModule","WDM","Component","constructor","props","_isMounted","hotTableComponent","hot","columns","restApi","handsontableDataBackup","handsontableData","alert","selectedRowCoords","r","c","editedRowCoords","state","data","newArrColumns","ColumnsInOrder","newArrData","newArrDataForPair","columnOptions","componentDidMount","company","localStorage","getItem","setSpinner","callApi","then","response","json","jsonBig","key","hasOwnProperty","push","console","log","a","length","jsonPair","forceUpdate","current","hotInstance","catch","err","setCellProperties","colCount","countCols","col","x","prop","readOnly","readOnlyInEditMode","getCellMeta","type","getDataType","setCellMeta","render","selectCell","handleEditClick","JSON","parse","stringify","setEdit","handleCancelClick","loadData","handleSaveClick","getDataAtRow","finalData","forEach","v","i","row","saveResult","exec_status","showMessage","SKU","resetRow","setState","newRowAdded","maximize","contentCSS","isDataExistsInDB","bind","mapStateToProps","token","language","fontSize","topologySelectedNodeFontSize","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, {createRef} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Axios from 'axios';\r\nimport { HotTable } from '@handsontable/react';\r\nimport 'handsontable/dist/handsontable.full.css';\r\nimport {Row, Col, Card, CardBody, CardFooter} from 'reactstrap';\r\nimport Header from '../components/Header';\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport RestApiModule from '../RestApiModule';\r\n\r\nimport {editOnToggle, spinnerToggle} from \"../redux/actions\";\r\n\r\nimport Toolbar from '../components/Toolbar';\r\nimport AlertModule from '../AlertModule'\r\n\r\nclass WDM extends React.Component {\r\n    _isMounted = false;\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n        this.hotTableComponent = createRef();\r\n        this.hot = null;\r\n        this.columns = [];\r\n        this.restApi = new RestApiModule();\r\n        this.handsontableDataBackup = null;\r\n        this.handsontableData = null;\r\n        this.alert = new AlertModule();\r\n        this.selectedRowCoords = {r: null, c: null};\r\n        this.editedRowCoords = {r: null, c: null};\r\n\r\n        this.state = {\r\n            columns: [\r\n            ],\r\n            data: [\r\n            ],\r\n            newArrColumns: [],\r\n            ColumnsInOrder: [\"SKU\",\"Tedarikçi SKU\",\"Ürün İsmi\", \"Liste Fiyatı\", \"Satış Fiyatı\", \"İnd.Oran(%)\", \"Stok Adet\", \"T.Adet\",\"T.Sıra\", \"Ürt.Tar.\", \"Hz.Sr.\"],\r\n            newArrData: [],\r\n            newArrDataForPair: [],\r\n            columnOptions: []\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        const company = localStorage.getItem('Company');\r\n\r\n        this.props.setSpinner();\r\n        this.restApi.callApi('exceldata', {\r\n            company: company,\r\n        }).then(response => {\r\n\r\n\r\n            const json = response.data[0];\r\n            const jsonBig = response.data;\r\n            for (let key in json) {\r\n                if (json.hasOwnProperty(key)) {\r\n                    this.state.newArrColumns.push(key);\r\n\r\n                }\r\n            }\r\n            console.log(this.state.ColumnsInOrder)\r\n/*\r\n            for(let a=0; a<jsonBig.length; a++){\r\n                const jsonPair = response.data[a];\r\n                console.log(jsonPair)\r\n                for(let key in jsonPair){\r\n                    console.log(key)\r\n                    if (jsonPair.hasOwnProperty(key)) {\r\n                        this.state.newArrData.push(jsonPair[key]);\r\n                    }\r\n                }\r\n                this.state.data.push(this.state.newArrData);\r\n                this.state.newArrData = [];\r\n            }\r\n            */\r\n\r\n            console.log(this.state.ColumnsInOrder[0])\r\n           for(let a=0; a<jsonBig.length; a++){\r\n               const jsonPair = response.data[a];\r\n               for(let c=0; c<11; c++){\r\n                   let key = this.state.ColumnsInOrder[c]\r\n                   this.state.newArrData.push(jsonPair[key]);\r\n               }\r\n               this.state.data.push(this.state.newArrData);\r\n               this.state.newArrData = [];\r\n            }\r\n            console.log(this.state.data)\r\n\r\n            this.state.columns.push(this.state.newArrColumns);\r\n            this.forceUpdate();\r\n\r\n            this.hot = this.hotTableComponent.current.hotInstance;\r\n            this.handsontableData = this.state.data;\r\n\r\n            //this.hot.setCellMeta(1, 4, \"className\", 'bg-primary text-white');\r\n            //this.hot.render();\r\n           /* var rows=this.hot.countRows();  // get the count of the rows in the table\r\n            var cols=this.hot.countCols();  // get the count of the columns in the table.\r\n            for(var row=0; row<rows; row++){  // go through each row of the table\r\n\r\n                    var cell = this.hot.getCell(row,1);\r\n                    cell.style.background = \"#00FF90\";\r\n\r\n            }\r\n\r\n            console.log(this.hot.getSettings())*/\r\n\r\n          //  this.hot.render();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        }).catch((err) => {\r\n    console.log(err);\r\n})\r\n\r\n        this.props.setSpinner();\r\n\r\n/*\r\n        //console.log(this.state.columns);\r\n        Axios({\r\n\r\n            method: 'POST',\r\n            url: `http://localhost:8777/test-jersey-rest-maven-tomcat/rest/testservice/test12/`,\r\n            data: null,\r\n            headers: {\r\n                'Content-Type' : 'application/json'\r\n            }\r\n        }).then(async (response) => {\r\n            console.log(\"aaaa\");\r\n\r\n            const json = response.data[0].variants[0];\r\n            const jsonBig = response.data[0].variants;\r\n            for (let key in json) {\r\n                if (json.hasOwnProperty(key)) {\r\n                    this.state.newArrColumns.push(key);\r\n                }\r\n            }\r\n\r\n            for(let a=0; a<jsonBig.length; a++){\r\n                const jsonPair = response.data[0].variants[a];\r\n                for(let key in jsonPair){\r\n                    if (jsonPair.hasOwnProperty(key)) {\r\n                        this.state.newArrData.push(jsonPair[key]);\r\n                    }\r\n                }\r\n                this.state.data.push(this.state.newArrData);\r\n                this.state.newArrData = [];\r\n            }\r\n            this.state.columns.push(this.state.newArrColumns);\r\n            this.forceUpdate();\r\n\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        })*/\r\n    }\r\n\r\n    setCellProperties(r, c) {\r\n\r\n        const colCount = this.hot.countCols();\r\n        let col = c !== null ? c : 0;\r\n\r\n\r\n        for (let x = 0; x <= colCount; x++) {\r\n            const {prop, readOnly, readOnlyInEditMode} = this.hot.getCellMeta(r,x);\r\n\r\n\r\n                    const type = this.hot.getDataType(r, x); // get cell type from loaded map\r\n\r\n\r\n                    col = col === 0 ? x : col; // when add new row find first editable col.\r\n\r\n                    this.hot.setCellMeta(r, x, \"editor\", type);\r\n                    this.hot.setCellMeta(r, x, \"className\", 'bg-warning text-dark');\r\n\r\n\r\n        }\r\n        this.hot.render();\r\n        this.hot.selectCell(r, col);\r\n    }\r\n\r\n    handleEditClick() {\r\n\r\n\r\n        const {r, c} = this.selectedRowCoords;\r\n        if (r === null && c === null) return;\r\n\r\n        this.handsontableDataBackup = JSON.parse(JSON.stringify(this.handsontableData));\r\n                    // Change edit mode on redux\r\n                    this.props.setEdit();\r\n\r\n                    this.setCellProperties(r, c);\r\n                    this.editedRowCoords.r = r;\r\n                    this.editedRowCoords.c = c;\r\n\r\n    }\r\n\r\n\r\n    handleCancelClick() {\r\n\r\n        this.handsontableData = JSON.parse(JSON.stringify(this.handsontableDataBackup));\r\n        this.hot.loadData(this.handsontableData);\r\n        this.hot.render();\r\n\r\n        // Change edit mode on redux\r\n        this.props.setEdit();\r\n\r\n    }\r\n\r\n\r\n    handleSaveClick() {\r\n      console.log(\"aaaa\")\r\n        const {r, c} = this.editedRowCoords;\r\n        let data = this.hot.getDataAtRow(r);\r\n        console.log(data);\r\n        console.log(this.state.ColumnsInOrder);\r\n       let finalData = {};\r\n\r\n        this.state.ColumnsInOrder.forEach((v,i) => {\r\n           finalData[v] = data[i]\r\n       });\r\n\r\n        console.log(finalData);\r\n\r\n        const company = localStorage.getItem('Company');\r\n        console.log(company);\r\n        this.restApi.callApi('saveRowAndSendFlxPoint', {\r\n            row: finalData,\r\n            company: company\r\n        }).then(response => {\r\n\r\n        const saveResult = response.exec_status;\r\n\r\n        if(saveResult == \"success\"){\r\n            this.alert.showMessage(\"success\",\r\n                \"Kayıt Başarılı\",\r\n                response.SKU + \" için kayıt başarılı\",\r\n                false\r\n            )\r\n            this.resetRow(r); // this method will return the edit view to normal\r\n           \r\n            this.props.setEdit();\r\n\r\n        }else{\r\n\r\n        }\r\n\r\n\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        })\r\n\r\n\r\n    }\r\n\r\n    resetRow(r) {\r\n        const colCount = this.hot.countCols();\r\n        for (let x = 0; x <= colCount; x++) {\r\n\r\n            this.hot.setCellMeta(r, x, \"editor\", false);\r\n            this.hot.setCellMeta(r, x, \"className\", 'bg-primary text-white');\r\n        }\r\n        this.hot.render();\r\n        this.setState({ newRowAdded : false});\r\n    }\r\n\r\n\r\n    render() {\r\n        return(\r\n            <>\r\n                <Header/>\r\n                <Row className=\"h-100\">\r\n                    <Sidebar maximize={this.props.maximize}/>\r\n                    <Col className={this.props.contentCSS}>\r\n                        <Toolbar\r\n                            wrapper={'toolbar mt-2'}\r\n                            isDataExist={this.state.isDataExistsInDB}\r\n                            newRowAdded={this.state.newRowAdded}\r\n                            edit={this.handleEditClick.bind(this)}\r\n                            cancel={this.handleCancelClick.bind(this)}\r\n                            save={this.handleSaveClick.bind(this)}\r\n                        />\r\n                        <Card className={'mt-1 fixedCard'}>\r\n                            <CardBody>\r\n                                <HotTable  ref={this.hotTableComponent} id={'hot'}\r\n                                           data={this.state.data}\r\n                                           stretchH={'all'}\r\n                                           autoRowSize={true}\r\n                                           autoWrapRow={true}\r\n                                           dropdownMenu={true}\r\n                                           filters={true}\r\n                                           manualColumnResize={true}\r\n                                           columnSorting={true}\r\n                                           colHeaders={this.state.ColumnsInOrder}\r\n                                           rowHeaders={true}\r\n                                           width={'100%'}\r\n                                           height={'100%'}\r\n                                           licenseKey=\"non-commercial-and-evaluation\"\r\n                                           afterSelectionEnd={(r, c) => {\r\n                                               this.selectedRowCoords.r = r;\r\n                                               this.selectedRowCoords.c = c;\r\n                                           }}\r\n                                />\r\n\r\n                            </CardBody>\r\n\r\n\r\n                        </Card>\r\n                    </Col>\r\n                </Row>\r\n\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        token: state.token,\r\n        company: state.company,\r\n        language: state.language,\r\n        maximize: state.maximize,\r\n        contentCSS: state.contentCSS,\r\n        fontSize: state.topologySelectedNodeFontSize,\r\n        spinnerToggle: state.spinnerToggle,\r\n    }\r\n}\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        setEdit: () => dispatch(editOnToggle()),\r\n        setSpinner: () => dispatch(spinnerToggle()),\r\n    }\r\n\r\n}\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(WDM);"]},"metadata":{},"sourceType":"module"}