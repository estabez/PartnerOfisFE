{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import{connect}from\"react-redux\";import{Modal,ModalHeader,ModalBody}from'reactstrap';import{modalExportToggle,spinnerToggle}from\"../redux/actions\";import FileUploadProgress from'react-fileupload-progress';import RestApiModule from'../RestApiModule';import data from'../sampleData/data';import{CSVLink}from'react-csv';var styles={progressWrapper:{height:'25px',marginTop:'10px',marginBottom:'10px',width:'100%',float:'left',overflow:'hidden',backgroundColor:'#f5f5f5',borderRadius:'4px',WebkitBoxShadow:'inset 0 1px 2px rgba(0,0,0,.1)',boxShadow:'inset 0 1px 2px rgba(0,0,0,.1)'},progressBar:{float:'left',width:'0',height:'100%',fontSize:'12px',lineHeight:'20px',color:'#fff',textAlign:'center',backgroundColor:'#5cb85c',WebkitBoxShadow:'inset 0 -1px 0 rgba(0,0,0,.15)',boxShadow:'inset 0 -1px 0 rgba(0,0,0,.15)',WebkitTransition:'width .6s ease',Otransition:'width .6s ease',transition:'width .6s ease'},cancelButton:{marginTop:'5px',WebkitAppearance:'none',padding:0,cursor:'pointer',background:'0 0',border:0,float:'left',fontSize:'21px',fontWeight:700,lineHeight:1,color:'#000',textShadow:'0 1px 0 #fff',filter:'alpha(opacity=20)',opacity:'.2'},bslabel:{display:'inline-block',maxWidth:'100%',marginBottom:'5px',fontWeight:700},bsHelp:{display:'block',marginTop:'5px',marginBottom:'10px',color:'#737373'},bsButton:{padding:'1px 5px',fontSize:'12px',lineHeight:'1.5',borderRadius:'3px',color:'#fff',backgroundColor:'#337ab7',borderColor:'#2e6da4',display:'inline-block',marginBottom:0,fontWeight:400,textAlign:'center',whiteSpace:'nowrap',verticalAlign:'middle',touchAction:'manipulation',cursor:'pointer',WebkitUserSelect:'none',MozUserSelect:'none',msUserSelect:'none',userSelect:'none',backgroundImage:'none',border:'1px solid transparent'}};var ModalExport=/*#__PURE__*/function(_React$Component){_inherits(ModalExport,_React$Component);function ModalExport(props){var _this;_classCallCheck(this,ModalExport);_this=_possibleConstructorReturn(this,_getPrototypeOf(ModalExport).call(this,props));_this.state={file:{},data:[],cols:[],fileJSON:[],loading:true,isUploadDisabled:true,isValidateDisabled:true,uploadHasError:true,uploadProgress:0,showProgress:false};_this.columnHeaders=[];_this.titles=[];_this.columns=[];_this.today=new Date();_this.todayDate=_this.today.getFullYear()+'-'+(_this.today.getMonth()+1)+'-'+_this.today.getDate();_this.fileName='DataMatrix_'+_this.todayDate+'.csv';_this.showProgress=false;_this.restApi=new RestApiModule();_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));return _this;}_createClass(ModalExport,[{key:\"handleChange\",value:function handleChange(e){this.chosenFile.innerText=e.target.files[0].name;var files=e.target.files;this.setState({isUploadDisabled:false});if(files&&files[0])this.setState({file:files[0]});}},{key:\"toggle\",value:function toggle(){this.props.setModalExport();}},{key:\"setStateAsync\",value:function setStateAsync(state){var _this2=this;return new Promise(function(resolve){_this2.setState(state,resolve);});}},{key:\"componentDidMount\",value:function componentDidMount(){this.getExportDataJSON();}},{key:\"getExportDataJSON\",value:function getExportDataJSON(){var _this3=this;console.log(this.props.regions);if(this.props.regions[0]){this.restApi.callApi('exportData',{token:this.props.token,region:this.props.regions[0]}).then(function(response){_this3.setStateAsync({fileJSON:response.ExportedExcelAsJSON});console.log(response);console.log(_this3.state.fileJSON);}).catch(function(error){console.log(error);});}}},{key:\"test\",value:function test(){console.log(this.state.fileJSON);}},{key:\"customFormRenderer\",value:function customFormRenderer(onSubmit){return React.createElement(\"form\",{id:\"customForm\",style:{marginBottom:'15px'}},React.createElement(\"div\",{className:'row'},React.createElement(\"div\",{className:'col-4'}),React.createElement(\"div\",{className:'col-8'},React.createElement(\"label\",{style:styles.bsHelp},this.fileName),React.createElement(\"button\",null,React.createElement(CSVLink,{data:this.state.fileJSON,filename:this.fileName,onClick:this.test.bind(this)},\"Export\")))));}},{key:\"formGetter\",value:function formGetter(){return this.state.fileJSON;}},{key:\"customProgressRenderer\",value:function customProgressRenderer(progress,hasError,cancelHandler){if(hasError||progress>-1){var barStyle=Object.assign({},styles.progressBar);barStyle.width=progress+'%';var message=React.createElement(\"span\",null,barStyle.width);if(hasError){barStyle.backgroundColor='#d9534f';message=React.createElement(\"span\",{style:{'color':'#a94442'}},\"Failed to upload ...\");}if(!hasError&&progress===100){message=React.createElement(\"span\",null,\"Done\");}return React.createElement(\"div\",null,React.createElement(\"div\",{style:styles.progressWrapper},React.createElement(\"div\",{style:barStyle})),React.createElement(\"div\",{className:'alert alert-info mt-2',style:{'clear':'left'}},message));}else{return;}}},{key:\"render\",value:function render(){var _this4=this;var language=this.props.language;if(language){return React.createElement(Modal,{isOpen:this.props.open,size:'l',centered:true},React.createElement(ModalHeader,{toggle:this.toggle.bind(this)},language.exportDataMatrixFile),React.createElement(ModalBody,null,React.createElement(FileUploadProgress,{key:\"ex2\",url:\"http://localhost:3000/api/upload\",method:\"post\",onProgress:function onProgress(e,request,progress){console.log('progress',e,request,progress);_this4.props.setSpinner();},onLoad:function onLoad(e,request){console.log('load',e,request);_this4.props.setSpinner();},onError:function onError(e,request){console.log('error',e,request);_this4.props.setSpinner();},onAbort:function onAbort(e,request){console.log('abort',e,request);_this4.props.setSpinner();},formGetter:this.formGetter.bind(this),formRenderer:this.customFormRenderer.bind(this),progressRenderer:this.customProgressRenderer.bind(this)})));}else{return React.createElement(React.Fragment,null);}}}]);return ModalExport;}(React.Component);function mapStateToProps(state){return{open:state.modalExportToggle,export:state.export,language:state.language,token:state.token,regions:state.regions};}function mapDispatchToProps(dispatch){return{setModalExport:function setModalExport(){return dispatch(modalExportToggle());},setSpinner:function setSpinner(){return dispatch(spinnerToggle());}};}export default connect(mapStateToProps,mapDispatchToProps)(ModalExport);","map":{"version":3,"sources":["C:/Users/ezerdon/Desktop/INWI/svn reps/E2E_Topology/E2ETopologyFrontend/src/src/components/ModalExport.jsx"],"names":["React","connect","Modal","ModalHeader","ModalBody","modalExportToggle","spinnerToggle","FileUploadProgress","RestApiModule","data","CSVLink","styles","progressWrapper","height","marginTop","marginBottom","width","float","overflow","backgroundColor","borderRadius","WebkitBoxShadow","boxShadow","progressBar","fontSize","lineHeight","color","textAlign","WebkitTransition","Otransition","transition","cancelButton","WebkitAppearance","padding","cursor","background","border","fontWeight","textShadow","filter","opacity","bslabel","display","maxWidth","bsHelp","bsButton","borderColor","whiteSpace","verticalAlign","touchAction","WebkitUserSelect","MozUserSelect","msUserSelect","userSelect","backgroundImage","ModalExport","props","state","file","cols","fileJSON","loading","isUploadDisabled","isValidateDisabled","uploadHasError","uploadProgress","showProgress","columnHeaders","titles","columns","today","Date","todayDate","getFullYear","getMonth","getDate","fileName","restApi","handleChange","bind","e","chosenFile","innerText","target","files","name","setState","setModalExport","Promise","resolve","getExportDataJSON","console","log","regions","callApi","token","region","then","response","setStateAsync","ExportedExcelAsJSON","catch","error","onSubmit","test","progress","hasError","cancelHandler","barStyle","Object","assign","message","language","open","toggle","exportDataMatrixFile","request","setSpinner","formGetter","customFormRenderer","customProgressRenderer","Component","mapStateToProps","export","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {Modal, ModalHeader, ModalBody} from 'reactstrap';\r\nimport {modalExportToggle, spinnerToggle} from \"../redux/actions\";\r\nimport FileUploadProgress from 'react-fileupload-progress';\r\nimport RestApiModule from '../RestApiModule';\r\nimport data from '../sampleData/data';\r\nimport { CSVLink } from 'react-csv'\r\n\r\n\r\n\r\nconst styles = {\r\n    progressWrapper: {\r\n        height: '25px',\r\n        marginTop: '10px',\r\n        marginBottom: '10px',\r\n        width: '100%',\r\n        float: 'left',\r\n        overflow: 'hidden',\r\n        backgroundColor: '#f5f5f5',\r\n        borderRadius: '4px',\r\n        WebkitBoxShadow: 'inset 0 1px 2px rgba(0,0,0,.1)',\r\n        boxShadow: 'inset 0 1px 2px rgba(0,0,0,.1)'\r\n    },\r\n    progressBar: {\r\n        float: 'left',\r\n        width: '0',\r\n        height: '100%',\r\n        fontSize: '12px',\r\n        lineHeight: '20px',\r\n        color: '#fff',\r\n        textAlign: 'center',\r\n        backgroundColor: '#5cb85c',\r\n        WebkitBoxShadow: 'inset 0 -1px 0 rgba(0,0,0,.15)',\r\n        boxShadow: 'inset 0 -1px 0 rgba(0,0,0,.15)',\r\n        WebkitTransition: 'width .6s ease',\r\n        Otransition: 'width .6s ease',\r\n        transition: 'width .6s ease'\r\n    },\r\n    cancelButton: {\r\n        marginTop: '5px',\r\n        WebkitAppearance: 'none',\r\n        padding: 0,\r\n        cursor: 'pointer',\r\n        background: '0 0',\r\n        border: 0,\r\n        float: 'left',\r\n        fontSize: '21px',\r\n        fontWeight: 700,\r\n        lineHeight: 1,\r\n        color: '#000',\r\n        textShadow: '0 1px 0 #fff',\r\n        filter: 'alpha(opacity=20)',\r\n        opacity: '.2'\r\n    },\r\n\r\n    bslabel: {\r\n        display: 'inline-block',\r\n        maxWidth: '100%',\r\n        marginBottom: '5px',\r\n        fontWeight: 700\r\n    },\r\n\r\n    bsHelp: {\r\n        display: 'block',\r\n        marginTop: '5px',\r\n        marginBottom: '10px',\r\n        color: '#737373'\r\n    },\r\n\r\n    bsButton: {\r\n        padding: '1px 5px',\r\n        fontSize: '12px',\r\n        lineHeight: '1.5',\r\n        borderRadius: '3px',\r\n        color: '#fff',\r\n        backgroundColor: '#337ab7',\r\n        borderColor: '#2e6da4',\r\n        display: 'inline-block',\r\n        marginBottom: 0,\r\n        fontWeight: 400,\r\n        textAlign: 'center',\r\n        whiteSpace: 'nowrap',\r\n        verticalAlign: 'middle',\r\n        touchAction: 'manipulation',\r\n        cursor: 'pointer',\r\n        WebkitUserSelect: 'none',\r\n        MozUserSelect: 'none',\r\n        msUserSelect: 'none',\r\n        userSelect: 'none',\r\n        backgroundImage: 'none',\r\n        border: '1px solid transparent'\r\n    }\r\n};\r\n\r\nclass ModalExport extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            file: {},\r\n            data: [],\r\n            cols: [],\r\n            fileJSON: [],\r\n            loading: true,\r\n            isUploadDisabled: true,\r\n            isValidateDisabled: true,\r\n            uploadHasError: true,\r\n            uploadProgress: 0,\r\n            showProgress: false,\r\n        }\r\n        this.columnHeaders = [];\r\n        this.titles = [];\r\n        this.columns = [];\r\n        this.today = new Date();\r\n        this.todayDate = this.today.getFullYear() + '-' + (this.today.getMonth()+1) + '-' + this.today.getDate();\r\n        this.fileName = 'DataMatrix_' + this.todayDate + '.csv';\r\n        this.showProgress = false;\r\n        this.restApi = new RestApiModule();\r\n        this.handleChange = this.handleChange.bind(this);\r\n    }\r\n\r\n    handleChange(e) {\r\n        this.chosenFile.innerText = e.target.files[0].name;\r\n        const files = e.target.files;\r\n        this.setState({\r\n            isUploadDisabled: false\r\n        })\r\n        if (files && files[0]) this.setState({file: files[0]});\r\n    };\r\n\r\n    toggle() {\r\n        this.props.setModalExport();\r\n    }\r\n    setStateAsync(state) {\r\n        return new Promise((resolve) => {\r\n            this.setState(state, resolve)\r\n        });\r\n    }\r\n\r\n\r\n    componentDidMount () {\r\n    this.getExportDataJSON();\r\n    }\r\n\r\n\r\n    getExportDataJSON () {\r\n        console.log(this.props.regions)\r\n        if(this.props.regions[0]) {\r\n            this.restApi.callApi('exportData', {\r\n                token: this.props.token,\r\n                region: this.props.regions[0]\r\n            }).then(response => {\r\n                this.setStateAsync({fileJSON: response.ExportedExcelAsJSON});\r\n                console.log(response);\r\n                console.log(this.state.fileJSON);\r\n            }).catch((error) => {\r\n                console.log(error)\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    test () {\r\n        console.log(this.state.fileJSON);\r\n    }\r\n\r\n    customFormRenderer(onSubmit) {\r\n        return (\r\n            <form id='customForm' style={{marginBottom: '15px'}}>\r\n                <div className={'row'}>\r\n                    <div className={'col-4'}></div>\r\n                    <div className={'col-8'}>\r\n                        <label style={styles.bsHelp}>{this.fileName}</label>\r\n                        <button>\r\n                            <CSVLink data={this.state.fileJSON} filename={this.fileName} onClick={this.test.bind(this)}>Export</CSVLink>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        );\r\n    }\r\n\r\n    formGetter() {\r\n        return this.state.fileJSON;\r\n    }\r\n\r\n    customProgressRenderer(progress, hasError, cancelHandler) {\r\n        if (hasError || progress > -1) {\r\n            let barStyle = Object.assign({}, styles.progressBar);\r\n            barStyle.width = progress + '%';\r\n\r\n            let message = (<span>{barStyle.width}</span>);\r\n            if (hasError) {\r\n                barStyle.backgroundColor = '#d9534f';\r\n                message = (<span style={{'color': '#a94442'}}>Failed to upload ...</span>);\r\n            }\r\n            if (!hasError && progress === 100) {\r\n                message = (<span>Done</span>);\r\n            }\r\n\r\n            return (\r\n                <div>\r\n                    <div style={styles.progressWrapper}>\r\n                        <div style={barStyle}></div>\r\n                    </div>\r\n                    <div className={'alert alert-info mt-2'} style={{'clear': 'left'}}>\r\n                        {message}\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else {\r\n            return;\r\n        }\r\n    }\r\n\r\n\r\n    render() {\r\n        const {language} = this.props;\r\n        if (language) {\r\n            return (\r\n                <Modal isOpen={this.props.open} size={'l'} centered={true}>\r\n                    <ModalHeader toggle={this.toggle.bind(this)}>{language.exportDataMatrixFile}</ModalHeader>\r\n                    <ModalBody>\r\n                        <FileUploadProgress key='ex2' url='http://localhost:3000/api/upload' method='post'\r\n                                            onProgress={(e, request, progress) => {\r\n                                                console.log('progress', e, request, progress);\r\n                                                this.props.setSpinner();\r\n                                            }}\r\n                                            onLoad={(e, request) => {\r\n                                                console.log('load', e, request);\r\n                                                this.props.setSpinner();\r\n                                            }}\r\n                                            onError={(e, request) => {\r\n                                                console.log('error', e, request);\r\n                                                this.props.setSpinner();\r\n                                            }}\r\n                                            onAbort={(e, request) => {\r\n                                                console.log('abort', e, request);\r\n                                                this.props.setSpinner();\r\n                                            }}\r\n                                            formGetter={this.formGetter.bind(this)}\r\n                                            formRenderer={this.customFormRenderer.bind(this)}\r\n                                            progressRenderer={this.customProgressRenderer.bind(this)}\r\n\r\n                        />\r\n                    </ModalBody>\r\n\r\n                </Modal>\r\n            )\r\n        } else {\r\n            return (<></>)\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        open: state.modalExportToggle,\r\n        export: state.export,\r\n        language: state.language,\r\n        token: state.token,\r\n        regions: state.regions\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return {\r\n        setModalExport: () => dispatch(modalExportToggle()),\r\n        setSpinner: () => dispatch(spinnerToggle()),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ModalExport);"]},"metadata":{},"sourceType":"module"}