{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\src\\\\views\\\\Wdm.jsx\";\nimport React from 'react';\nimport { connect } from \"react-redux\";\nimport Toolbar from '../components/TopologyToolbar';\nimport Header from \"../components/Header\";\nimport Sidebar from \"../components/Sidebar\";\nimport TopologyDiagram from '../components/TopologyDiagram';\nimport IconModule from '../IconModule';\nimport RestApiModule from '../RestApiModule';\n\nclass WDM extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      graph: null,\n      labels: null\n    };\n    this.unformatedData = null;\n    this.restApi = new RestApiModule();\n  }\n\n  componentDidMount() {\n    this.getWdmTopologyData();\n  }\n\n  getWdmTopologyData() {\n    this.restApi.callApi('wdm', {\n      token: \"FQl65eASqnHaYSxumlMP53mU0Tc3ovh1Mas2QHdd4CZY2XfP0qtZlGMq7vtiY1m3\"\n    }).then(response => {\n      this.prepareData(response.WDMTopologyViewData);\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  prepareData(json) {\n    const nodes = [],\n          edges = [],\n          labels = [];\n    const Icons = new IconModule();\n    const Site = Icons.getIconForNode('AGGREGATE_SITE');\n    let graph = null;\n\n    function pushItem(label) {\n      labels.push(label);\n      nodes.push({\n        id: label,\n        label,\n        shape: 'image',\n        font: {\n          color: 'black',\n          size: 13\n        },\n        image: Site\n      });\n    }\n\n    if (json) {\n      json.map(item => {\n        const indexA = nodes.findIndex(data => data.label === item.A_SIDE_SITE);\n        const indexZ = nodes.findIndex(data => data.label === item.Z_SIDE_SITE);\n\n        if (indexA < 0) {\n          pushItem(item.A_SIDE_SITE);\n        }\n\n        if (indexZ < 0) {\n          pushItem(item.Z_SIDE_SITE);\n        }\n\n        let title = `<strong>Name: </strong>${item.NAME}<br /><strong>Status: </strong>${item.STATUS}<br />`;\n        title += `<strong>A Side Equip: </strong>${item.A_SIDE_SITE}<br />`;\n        title += `<strong>Z Side Equip: </strong>${item.Z_SIDE_SITE}`;\n        edges.push({\n          from: item.A_SIDE_SITE,\n          to: item.Z_SIDE_SITE,\n          title: title\n        });\n      });\n      graph = {\n        nodes,\n        edges\n      };\n      this.unformatedData = graph;\n      this.setState({\n        graph\n      });\n      this.setState({\n        labels: labels.sort()\n      });\n    }\n  }\n\n  async handleSelectNode(selectedNodeId) {\n    let newGraph = JSON.parse(JSON.stringify(this.unformatedData));\n\n    if (newGraph) {\n      newGraph.nodes.map(node => {\n        if (node.label === selectedNodeId) {\n          node.font = {\n            color: 'red',\n            size: this.props.fontSize\n          };\n        }\n      });\n      this.setState({\n        graph: newGraph\n      });\n    }\n  }\n\n  render() {\n    const _this$props = this.props,\n          language = _this$props.language,\n          maximize = _this$props.maximize,\n          contentCSS = _this$props.contentCSS;\n    const graph = this.state.graph;\n\n    if (language !== null && graph !== null) {\n      return React.createElement(React.Fragment, null, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row h-100\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(Sidebar, {\n        maximize: maximize,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: contentCSS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        wrapper: 'card mt-3',\n        labels: this.state.labels,\n        handleSelectNode: this.handleSelectNode.bind(this),\n        diagramAreaId: 'WdmTopology',\n        snapshotFileName: 'WdmTopology.png',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: 'WdmTopology',\n        className: 'card mt-3 fixedCard',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: 'topologyViewHeader',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, language.wdmTopology), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(TopologyDiagram, {\n        graph: this.state.graph,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }))))));\n    } else {\n      return React.createElement(React.Fragment, null);\n    }\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    serverPath: state.serverPath,\n    language: state.language,\n    maximize: state.maximize,\n    contentCSS: state.contentCSS,\n    fontSize: state.topologySelectedNodeFontSize\n  };\n}\n\nexport default connect(mapStateToProps)(WDM);","map":{"version":3,"sources":["C:/Users/ezerdon/Desktop/INWI/svn reps/E2E_Topology/E2ETopologyFrontend/src/src/views/Wdm.jsx"],"names":["React","connect","Toolbar","Header","Sidebar","TopologyDiagram","IconModule","RestApiModule","WDM","Component","constructor","props","state","graph","labels","unformatedData","restApi","componentDidMount","getWdmTopologyData","callApi","token","then","response","prepareData","WDMTopologyViewData","catch","error","console","log","json","nodes","edges","Icons","Site","getIconForNode","pushItem","label","push","id","shape","font","color","size","image","map","item","indexA","findIndex","data","A_SIDE_SITE","indexZ","Z_SIDE_SITE","title","NAME","STATUS","from","to","setState","sort","handleSelectNode","selectedNodeId","newGraph","JSON","parse","stringify","node","fontSize","render","language","maximize","contentCSS","bind","wdmTopology","mapStateToProps","serverPath","topologySelectedNodeFontSize"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {connect} from \"react-redux\";\r\n\r\nimport Toolbar from '../components/TopologyToolbar'\r\nimport Header from \"../components/Header\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport TopologyDiagram from '../components/TopologyDiagram'\r\n\r\nimport IconModule from '../IconModule';\r\nimport RestApiModule from '../RestApiModule'\r\n\r\nclass WDM extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            graph: null,\r\n            labels: null\r\n        }\r\n\r\n        this.unformatedData = null\r\n\r\n        this.restApi = new RestApiModule();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getWdmTopologyData();\r\n    }\r\n\r\n    getWdmTopologyData() {\r\n\r\n        this.restApi.callApi('wdm', {\r\n            token: \"FQl65eASqnHaYSxumlMP53mU0Tc3ovh1Mas2QHdd4CZY2XfP0qtZlGMq7vtiY1m3\"\r\n\r\n        }).then((response) => {\r\n\r\n            this.prepareData(response.WDMTopologyViewData);\r\n\r\n        }).catch((error) => {\r\n            console.log(error)\r\n        });\r\n    }\r\n\r\n    prepareData(json) {\r\n\r\n        const nodes = [], edges = [], labels = [];\r\n        const Icons = new IconModule();\r\n        const Site = Icons.getIconForNode('AGGREGATE_SITE');\r\n\r\n        let graph = null;\r\n\r\n        function pushItem(label) {\r\n\r\n            labels.push(label);\r\n\r\n            nodes.push({\r\n                id: label,\r\n                label,\r\n                shape: 'image',\r\n                font: {color: 'black', size: 13},\r\n                image: Site\r\n            })\r\n        }\r\n\r\n        if (json) {\r\n\r\n            json.map((item) => {\r\n                const indexA = nodes.findIndex(data => data.label === item.A_SIDE_SITE);\r\n                const indexZ = nodes.findIndex(data => data.label === item.Z_SIDE_SITE);\r\n\r\n                if (indexA < 0) {\r\n                    pushItem(item.A_SIDE_SITE)\r\n                }\r\n\r\n                if (indexZ < 0) {\r\n                    pushItem(item.Z_SIDE_SITE)\r\n                }\r\n\r\n                let title = `<strong>Name: </strong>${item.NAME}<br /><strong>Status: </strong>${item.STATUS}<br />`;\r\n                title += `<strong>A Side Equip: </strong>${item.A_SIDE_SITE}<br />`;\r\n                title += `<strong>Z Side Equip: </strong>${item.Z_SIDE_SITE}`;\r\n\r\n                edges.push({\r\n                    from: item.A_SIDE_SITE,\r\n                    to: item.Z_SIDE_SITE,\r\n                    title: title\r\n                });\r\n\r\n            });\r\n\r\n            graph = {\r\n                nodes,\r\n                edges\r\n            };\r\n\r\n            this.unformatedData = graph;\r\n            this.setState({graph});\r\n            this.setState({labels: labels.sort()});\r\n        }\r\n    }\r\n\r\n    async handleSelectNode(selectedNodeId) {\r\n\r\n        let newGraph = JSON.parse(JSON.stringify(this.unformatedData));\r\n        if (newGraph) {\r\n            newGraph.nodes.map((node) => {\r\n                if (node.label === selectedNodeId) {\r\n                    node.font = {color: 'red', size: this.props.fontSize}\r\n                }\r\n            });\r\n            this.setState({graph: newGraph});\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const {language, maximize, contentCSS} = this.props;\r\n        const {graph} = this.state;\r\n\r\n        if (language !== null && graph !== null) {\r\n\r\n            return (\r\n                <>\r\n                    <Header/>\r\n                    <div className=\"row h-100\">\r\n                        <Sidebar maximize={maximize}/>\r\n                        <div className={contentCSS}>\r\n                            <Toolbar wrapper={'card mt-3'}\r\n                                     labels={this.state.labels}\r\n                                     handleSelectNode={this.handleSelectNode.bind(this)}\r\n                                     diagramAreaId={'WdmTopology'}\r\n                                     snapshotFileName={'WdmTopology.png'}\r\n                            />\r\n                            <div id={'WdmTopology'}  className={'card mt-3 fixedCard'}>\r\n                                <label className={'topologyViewHeader'} >{language.wdmTopology}</label>\r\n                                <hr />\r\n                                <div className=\"card-body\">\r\n                                    <TopologyDiagram\r\n                                        graph={this.state.graph}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </>\r\n            )\r\n        } else {\r\n            return (<></>);\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        serverPath: state.serverPath,\r\n        language: state.language,\r\n        maximize: state.maximize,\r\n        contentCSS: state.contentCSS,\r\n        fontSize: state.topologySelectedNodeFontSize\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(WDM);"]},"metadata":{},"sourceType":"module"}