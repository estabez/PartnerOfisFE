{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ezerdon\\\\Desktop\\\\INWI\\\\svn reps\\\\E2E_Topology\\\\E2ETopologyFrontend\\\\src\\\\src\\\\views\\\\Core.jsx\";\nimport React from 'react';\nimport { connect } from \"react-redux\";\nimport Toolbar from '../components/TopologyToolbar';\nimport Header from \"../components/Header\";\nimport Sidebar from \"../components/Sidebar\";\nimport TopologyDiagram from '../components/TopologyDiagram';\nimport IconModule from '../IconModule';\nimport RestApiModule from '../RestApiModule';\n\nclass Core extends React.Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n    this.state = {\n      graph: null,\n      labels: null\n    };\n    this.unformatedData = null;\n    this.restApi = new RestApiModule();\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.getCoreTopologyData();\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  getCoreTopologyData() {\n    this.restApi.callApi('core', {\n      token: this.props.token\n    }).then(response => {\n      if (this._isMounted) this.prepareData(response.CoreTopologyViewData);\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  prepareData(json) {\n    const nodes = [],\n          edges = [],\n          labels = [];\n    const Icons = new IconModule();\n    let graph = null;\n\n    function pushItem(id, label, icon) {\n      labels.push(label);\n      nodes.push({\n        id,\n        label,\n        shape: 'image',\n        font: {\n          color: 'black'\n        },\n        image: icon\n      });\n    }\n\n    if (json) {\n      json.map(item => {\n        const index1 = nodes.findIndex(data => data.id === item.CONTROLLER_INST_ID);\n        const index2 = nodes.findIndex(data => data.id === item.MGW_INST_ID);\n\n        if (index1 < 0) {\n          pushItem(item.CONTROLLER_INST_ID, item.CONTROLLER_NAME, Icons.getIconForNode(item.CONTROLLER_TYPE));\n        }\n\n        if (index2 < 0) {\n          pushItem(item.MGW_INST_ID, item.MGW_NAME, Icons.getIconForNode('AGGREGATE_SITE'));\n        }\n\n        edges.push({\n          from: item.CONTROLLER_INST_ID,\n          to: item.MGW_INST_ID,\n          dashes: true\n        });\n      });\n      graph = {\n        nodes,\n        edges\n      };\n      this.unformatedData = graph;\n      this.setState({\n        graph\n      });\n      this.setState({\n        labels: labels.sort()\n      });\n    }\n  }\n\n  async handleSelectNode(selectedNodeId) {\n    let newGraph = JSON.parse(JSON.stringify(this.unformatedData));\n\n    if (newGraph) {\n      newGraph.nodes.map(node => {\n        if (node.label === selectedNodeId) {\n          node.font = {\n            color: 'red',\n            size: this.props.fontSize\n          };\n        }\n      });\n      this.setState({\n        graph: newGraph\n      });\n    }\n  }\n\n  render() {\n    const _this$props = this.props,\n          language = _this$props.language,\n          maximize = _this$props.maximize,\n          contentCSS = _this$props.contentCSS;\n    const graph = this.state.graph;\n\n    if (language !== null && graph !== null) {\n      return React.createElement(React.Fragment, null, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row h-100\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(Sidebar, {\n        maximize: maximize,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: contentCSS,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        wrapper: 'card toolbar mt-2',\n        labels: this.state.labels,\n        handleSelectNode: this.handleSelectNode.bind(this),\n        diagramAreaId: 'CoreTopology',\n        snapshotFileName: 'CoreTopology.png',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        id: 'CoreTopology',\n        className: 'card mt-1 fixedCard',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: 'topologyViewHeader',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, language.coreTopology), React.createElement(TopologyDiagram, {\n        height: '95% ',\n        graph: this.state.graph,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }))))));\n    } else {\n      return React.createElement(React.Fragment, null);\n    }\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    token: state.token,\n    language: state.language,\n    maximize: state.maximize,\n    contentCSS: state.contentCSS,\n    fontSize: state.topologySelectedNodeFontSize\n  };\n}\n\nexport default connect(mapStateToProps)(Core);","map":{"version":3,"sources":["C:/Users/ezerdon/Desktop/INWI/svn reps/E2E_Topology/E2ETopologyFrontend/src/src/views/Core.jsx"],"names":["React","connect","Toolbar","Header","Sidebar","TopologyDiagram","IconModule","RestApiModule","Core","Component","constructor","props","_isMounted","state","graph","labels","unformatedData","restApi","componentDidMount","getCoreTopologyData","componentWillUnmount","callApi","token","then","response","prepareData","CoreTopologyViewData","catch","error","console","log","json","nodes","edges","Icons","pushItem","id","label","icon","push","shape","font","color","image","map","item","index1","findIndex","data","CONTROLLER_INST_ID","index2","MGW_INST_ID","CONTROLLER_NAME","getIconForNode","CONTROLLER_TYPE","MGW_NAME","from","to","dashes","setState","sort","handleSelectNode","selectedNodeId","newGraph","JSON","parse","stringify","node","size","fontSize","render","language","maximize","contentCSS","bind","coreTopology","mapStateToProps","topologySelectedNodeFontSize"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {connect} from \"react-redux\";\r\n\r\nimport Toolbar from '../components/TopologyToolbar'\r\nimport Header from \"../components/Header\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport TopologyDiagram from '../components/TopologyDiagram'\r\n\r\nimport IconModule from '../IconModule';\r\nimport RestApiModule from '../RestApiModule'\r\n\r\nclass Core extends React.Component {\r\n    _isMounted = false;\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            graph: null,\r\n            labels: null\r\n        }\r\n\r\n        this.unformatedData = null\r\n\r\n        this.restApi = new RestApiModule();\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n        this.getCoreTopologyData();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n    getCoreTopologyData() {\r\n\r\n        this.restApi.callApi('core', {\r\n            token: this.props.token\r\n\r\n        }).then((response) => {\r\n\r\n            if (this._isMounted)\r\n                this.prepareData(response.CoreTopologyViewData);\r\n\r\n        }).catch((error) => {\r\n            console.log(error)\r\n        });\r\n    }\r\n\r\n    prepareData(json) {\r\n\r\n        const nodes = [], edges = [], labels = [];\r\n        const Icons = new IconModule();\r\n        let graph = null;\r\n\r\n        function pushItem(id, label, icon) {\r\n\r\n            labels.push(label);\r\n\r\n            nodes.push({\r\n                id,\r\n                label,\r\n                shape: 'image',\r\n                font: {color: 'black'},\r\n                image: icon\r\n            })\r\n        }\r\n\r\n        if (json) {\r\n\r\n            json.map((item) => {\r\n                const index1 = nodes.findIndex(data => data.id === item.CONTROLLER_INST_ID);\r\n                const index2 = nodes.findIndex(data => data.id === item.MGW_INST_ID);\r\n\r\n                if (index1 < 0) {\r\n                    pushItem(item.CONTROLLER_INST_ID,\r\n                        item.CONTROLLER_NAME,\r\n                        Icons.getIconForNode(item.CONTROLLER_TYPE)\r\n                    );\r\n                }\r\n\r\n                if (index2 < 0) {\r\n                    pushItem(item.MGW_INST_ID,\r\n                        item.MGW_NAME,\r\n                        Icons.getIconForNode('AGGREGATE_SITE')\r\n                    );\r\n                }\r\n\r\n                edges.push({\r\n                    from: item.CONTROLLER_INST_ID,\r\n                    to: item.MGW_INST_ID,\r\n                    dashes: true,\r\n                });\r\n            });\r\n\r\n            graph = {\r\n                nodes,\r\n                edges\r\n            };\r\n\r\n            this.unformatedData = graph;\r\n            this.setState({graph});\r\n            this.setState({labels: labels.sort()});\r\n        }\r\n    }\r\n\r\n    async handleSelectNode(selectedNodeId) {\r\n\r\n        let newGraph = JSON.parse(JSON.stringify(this.unformatedData));\r\n        if (newGraph) {\r\n            newGraph.nodes.map((node) => {\r\n                if (node.label === selectedNodeId) {\r\n                    node.font = {color: 'red', size: this.props.fontSize}\r\n                }\r\n            });\r\n            this.setState({graph: newGraph});\r\n        }\r\n    };\r\n\r\n\r\n    render() {\r\n        const {language, maximize, contentCSS} = this.props;\r\n        const {graph} = this.state;\r\n\r\n        if (language !== null && graph !== null) {\r\n\r\n            return (\r\n                <>\r\n                    <Header/>\r\n                    <div className=\"row h-100\">\r\n                        <Sidebar maximize={maximize}/>\r\n                        <div className={contentCSS}>\r\n                            <Toolbar wrapper={'card toolbar mt-2'}\r\n                                     labels={this.state.labels}\r\n                                     handleSelectNode={this.handleSelectNode.bind(this)}\r\n                                     diagramAreaId={'CoreTopology'}\r\n                                     snapshotFileName={'CoreTopology.png'}\r\n                            />\r\n                            <div id={'CoreTopology'} className={'card mt-1 fixedCard'}>\r\n                                <div className=\"card-body\">\r\n                                    <h4 className={'topologyViewHeader'}>{language.coreTopology}</h4>\r\n                                    <TopologyDiagram\r\n                                        height={'95% '}\r\n                                        graph={this.state.graph}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </>\r\n            )\r\n        } else {\r\n            return (<></>);\r\n        }\r\n    }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n    return {\r\n        token: state.token,\r\n        language: state.language,\r\n        maximize: state.maximize,\r\n        contentCSS: state.contentCSS,\r\n        fontSize: state.topologySelectedNodeFontSize\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Core);"]},"metadata":{},"sourceType":"module"}